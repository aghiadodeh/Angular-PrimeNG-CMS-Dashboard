<div class="generic-autocomplete w-full">
  <p-autoComplete
    [class]="'w-full' + (invalid ? ' ng-dirty ng-invalid' : '')"
    [(ngModel)]="option"
    [disabled]="disabled ?? false"
    [suggestions]="suggestions"
    [dropdown]="configuration.dropdown"
    [forceSelection]="true"
    [unique]="true"
    [delay]="500"
    [multiple]="configuration.multiple"
    [appendTo]="'body'"
    [dataKey]="configuration.valueBy"
    [field]="configuration.optionLabel"
    [group]="configuration.group"
    [showClear]="configuration.showClear ?? true"
    (completeMethod)="search($event)"
    (ngModelChange)="onChange($event)"
    appendTo="body"
  >
    @if (configuration.template; as template) {
      <!-- input selected item -->
      <ng-template let-item pTemplate="selectedItem">
        <div class="flex align-items-center" [ngClass]="template.ngClass">
          @if (template.imageSrc) {
            <img [src]="template.imageSrc | functionPipe: item" />
          }
          <span>{{ item[configuration.optionLabel] }}</span>
        </div>
      </ng-template>

      <!-- dropdown suggestion item -->
      <ng-template let-item pTemplate="item">
        <div class="flex align-items-center" [ngClass]="template.ngClass">
          @if (template.imageSrc) {
            <img [src]="template.imageSrc | functionPipe: item" />
          }
          <span>{{ item[configuration.optionLabel] }}</span>
        </div>
      </ng-template>
    }
  </p-autoComplete>
</div>
